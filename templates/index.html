{% extends "base.html" %}
{% block content %}

<h2>Annotation Portal</h2>        
<div class="row">
    <div class="col-md-10">
        <div class="lead">
        <p>This is a demo for a NeuroVault annotation portal. For more information, see the <a href="/faq">FAQ</a></p>
        </div>     
        {% if annotations %}

        <!-- Annotation Modal -->
        <div id='annotation_modal' class='modal' data-backdrop='static' style='margin-top: 175px;'>
            <div class='modal-dialog'>
                <div class='modal-content'>
                    <div class='modal-header'>
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true" onclick="hideModal()">&times;</button>
                        <h4 class="modal-title">Annotations</h4>
                    </div>
                    <div class='modal-body'>
                        <div class="well">
                        {% for url, annots in annotations.iteritems() %}
                            {% for annot_name, annot_value in annots.iteritems() %}
                                <dt>{{ annot_name }}</dt>
                                <dd>{{ annot_value }}</dd>
                            {% endfor %}
                        {% endfor %}
                        </div>        
                    </div>
                </div>
            </div>
        </div><!-- close modal -->

        <script>
        $(document).ready(function() {
            showModal();
        });
        </script>

        {% endif %} 
    </div>
    <div class="col-md-2">
       <button class="btn btn-small btn-success" style="opacity:1.0" disabled>Defined</button>
       <button class="btn btn-small btn-danger" style="opacity:1.0" disabled>Missing</button>
    </div>
</div>
<!-- Each paper will have a tab-->
<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
{% for collection in collections %}
    <div class="panel panel-default">
        <div class="panel-heading" role="tab" id="headingOne" style="height:50px">
            <h4 class="panel-title">
                <a role="button" data-toggle="collapse" data-parent="#accordion" href="#{{ collection.collection_id }}" aria-expanded="true" aria-controls="{{ collection.collection_id }}">
                    <div class="row">
                        <div class="col-md-10">
                            {{ collection.name }}
                        </div>
                        <div class="col-md-2">
                            <div class="float-right-wrapper">
                                <button class="btn btn-small btn-success" style="opacity:1.0" disabled>{{ collection.defined_annotations }}</button>
                                <button class="btn btn-small btn-danger" style="opacity:1.0" disabled>{{ collection.missing_annotations }}</button>
                            </div>
                        </div>
                    </div>
                </a>
            </h4>
        </div>
        <div id="{{ collection.collection_id }}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
            <div class="panel-body">
                <div class="col-md-4">
                <h3>Missing Annotations</h3>
                {% for key, value in collection.iteritems() %}
                    {% if value == "None" or value == "nan" %}
                       <dd>{{ key }}</dd>
                    {% endif %}
                {% endfor %}
                </div>
                <div class="col-md-4">
                    <h3>Authors</h3>
                    <dd>{{ collection.authors }}</dd>
                    <h3>Journal</h3>
                    <dd>{{ collection.journal_name }}</dd>
                </div>
                <div class="col-md-4" style="margin-top:20px">
                   <div class="float-right-wrapper">
                   <a href="{{ collection.url }}" target="_blank">
                        <button class="btn btn-default btn-lg" type="button">Annotate</button>
                   </a><br>
                   <a href="/annotate/{{ collection.collection_id }}">
                        <button class="btn btn-default btn-lg" type="button">View Annotations</button>
                   </a>
                   </div>
                </div>
             </div>
        </div>
    </div>
{% endfor %}
</div>
<script>
function showModal(upload_type) {
    document.getElementById('annotation_modal').style.display = 'block';
    document.getElementById('fade').style.display = 'block';
}
function hideModal() {
    document.getElementById('annotation_modal').style.display = 'none';
    document.getElementById('fade').style.display = 'none';
}
</script>
{% endblock %}
